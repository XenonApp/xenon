{"version":3,"sources":["../../../../src/config/default/command/web_router.js"],"names":["session","xenon","module","exports","info","routes","request","path","console","log","i","length","route","regex","RegExp","pattern","m","exec","rewritePath","undefined","cmd","command","callCommand","fs","prefix","status","body"],"mappings":";;AAAA,IAAIA,UAAUC,MAAMD,OAApB;;AAEAE,OAAOC,OAAP,GAAiB,UAASC,IAAT,EAAe;AAC5B,QAAIC,SAASD,KAAKC,MAAlB;AACA,QAAIC,UAAUF,KAAKE,OAAnB;AACA,QAAIC,OAAOH,KAAKG,IAAhB;;AAEAC,YAAQC,GAAR,CAAY,MAAZ,EAAoBH,QAAQC,IAA5B;;AAEA,SAAI,IAAIG,IAAI,CAAZ,EAAeA,IAAIL,OAAOM,MAA1B,EAAkCD,GAAlC,EAAuC;AACnC,YAAIE,QAAQP,OAAOK,CAAP,CAAZ;AACA,YAAIG,QAAQ,IAAIC,MAAJ,CAAWF,MAAMG,OAAjB,CAAZ;AACA,YAAIC,IAAIH,MAAMI,IAAN,CAAWX,QAAQC,IAAnB,CAAR;AACA,YAAGS,CAAH,EAAM;AACF;AACA,gBAAGJ,MAAMM,WAAN,KAAsBC,SAAzB,EAAoC;AAChCb,wBAAQC,IAAR,GAAeS,EAAEJ,MAAMM,WAAR,CAAf;AACH;AACD,gBAAIE,MAAMR,MAAMS,OAAhB;AACA,mBAAOrB,QAAQsB,WAAR,CAAoBf,IAApB,EAA0Ba,GAA1B,EAA+B;AAClCG,oBAAIX,MAAMW,EADwB;AAElCC,wBAAQZ,MAAMY,MAFoB;AAGlClB,yBAASA;AAHyB,aAA/B,CAAP;AAKH;AACJ;;AAED,WAAO;AACHmB,gBAAQ,GADL;AAEHC,cAAM;AAFH,KAAP;AAIH,CA7BD","file":"web_router.js","sourcesContent":["var session = xenon.session;\n\nmodule.exports = function(info) {\n    var routes = info.routes;\n    var request = info.request;\n    var path = info.path;\n\n    console.log(\"Path\", request.path);\n\n    for(var i = 0; i < routes.length; i++) {\n        var route = routes[i];\n        var regex = new RegExp(route.pattern);\n        var m = regex.exec(request.path);\n        if(m) {\n            // console.log(\"Route match\", route, m);\n            if(route.rewritePath !== undefined) {\n                request.path = m[route.rewritePath];\n            }\n            var cmd = route.command;\n            return session.callCommand(path, cmd, {\n                fs: route.fs,\n                prefix: route.prefix,\n                request: request\n            });\n        }\n    }\n\n    return {\n        status: 404,\n        body: \"No matching routes\"\n    };\n};\n"]}