{"version":3,"sources":["../../../src/js/lib/ace_popup.js"],"names":["dom","global","ace","require","AcePopupExisting","AcePopup","module","exports","popup","apply","arguments","bgTokenizer","session","$tokenizeRow","row","data","tokens","value","caption","name","last","flag","c","i","length","matchMask","push","type","className","meta","maxW","renderer","$size","scrollerWidth","layerConfig","characterWidth","icon","importCssString"],"mappings":"AAAA;;AAEA,IAAIA,MAAMC,OAAOC,GAAP,CAAWC,OAAX,CAAmB,aAAnB,CAAV;AACA,IAAIC,mBAAmBH,OAAOC,GAAP,CAAWC,OAAX,CAAmB,wBAAnB,EAA6CE,QAApE;;AAEA;AACA;;AAEAC,OAAOC,OAAP,CAAeF,QAAf,GAA0B,YAAW;AACjC,QAAIG,QAAQJ,iBAAiBK,KAAjB,CAAuB,IAAvB,EAA6BC,SAA7B,CAAZ;AACA,QAAIC,cAAcH,MAAMI,OAAN,CAAcD,WAAhC;AACAA,gBAAYE,YAAZ,GAA2B,UAASC,GAAT,EAAc;AACrC,YAAIC,OAAOP,MAAMO,IAAN,CAAWD,GAAX,CAAX;AACA,YAAIE,SAAS,EAAb;AACA,YAAI,CAACD,IAAL,EACI,OAAOC,MAAP;AACJ,YAAI,OAAOD,IAAP,IAAe,QAAnB,EACIA,OAAO,EAACE,OAAOF,IAAR,EAAP;AACJ,YAAI,CAACA,KAAKG,OAAV,EACIH,KAAKG,OAAL,GAAeH,KAAKE,KAAL,IAAcF,KAAKI,IAAlC;;AAEJ,YAAIC,OAAO,CAAC,CAAZ;AACA,YAAIC,IAAJ,EAAUC,CAAV;AACA,aAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIR,KAAKG,OAAL,CAAaM,MAAjC,EAAyCD,GAAzC,EAA8C;AAC1CD,gBAAIP,KAAKG,OAAL,CAAaK,CAAb,CAAJ;AACAF,mBAAON,KAAKU,SAAL,GAAkB,KAAKF,CAAvB,GAA4B,CAA5B,GAAgC,CAAvC;AACA,gBAAIH,SAASC,IAAb,EAAmB;AACfL,uBAAOU,IAAP,CAAY,EAACC,MAAMZ,KAAKa,SAAL,IAAkB,MAAOP,OAAO,sBAAP,GAAgC,EAAvC,CAAzB,EAAqEJ,OAAOK,CAA5E,EAAZ;AACAF,uBAAOC,IAAP;AACH,aAHD,MAGO;AACHL,uBAAOA,OAAOQ,MAAP,GAAgB,CAAvB,EAA0BP,KAA1B,IAAmCK,CAAnC;AACH;AACJ;;AAED,YAAIP,KAAKc,IAAT,EAAe;AACX,gBAAIC,OAAOtB,MAAMuB,QAAN,CAAeC,KAAf,CAAqBC,aAArB,GAAqCzB,MAAMuB,QAAN,CAAeG,WAAf,CAA2BC,cAA3E;AACA,gBAAIpB,KAAKc,IAAL,CAAUL,MAAV,GAAmBT,KAAKG,OAAL,CAAaM,MAAhC,GAAyCM,OAAO,CAApD,EACId,OAAOU,IAAP,CAAY,EAACC,MAAM,kBAAP,EAA2BV,OAAOF,KAAKc,IAAvC,EAAZ;AACP;AACD;AACA,YAAId,KAAKqB,IAAT,EAAe;AACXpB,mBAAOU,IAAP,CAAY,EAACC,MAAM,UAAUZ,KAAKqB,IAAtB,EAA4BnB,OAAO,EAAnC,EAAZ;AACH;;AAGD,eAAOD,MAAP;AACH,KAnCD;;AAqCA,WAAOR,KAAP;AACH,CAzCD;;AA2CAR,IAAIqC,eAAJ,CAAoB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EAApB","file":"ace_popup.js","sourcesContent":["\"use strict\";\n\nvar dom = global.ace.require(\"ace/lib/dom\");\nvar AcePopupExisting = global.ace.require(\"ace/autocomplete/popup\").AcePopup;\n\n// So this is some insane monkey patching magic. We have to override the tokenizer\n// in order to add the icon tokens\n\nmodule.exports.AcePopup = function() {\n    var popup = AcePopupExisting.apply(this, arguments);\n    var bgTokenizer = popup.session.bgTokenizer;\n    bgTokenizer.$tokenizeRow = function(row) {\n        var data = popup.data[row];\n        var tokens = [];\n        if (!data)\n            return tokens;\n        if (typeof data == \"string\")\n            data = {value: data};\n        if (!data.caption)\n            data.caption = data.value || data.name;\n\n        var last = -1;\n        var flag, c;\n        for (var i = 0; i < data.caption.length; i++) {\n            c = data.caption[i];\n            flag = data.matchMask & (1 << i) ? 1 : 0;\n            if (last !== flag) {\n                tokens.push({type: data.className || \"\" + ( flag ? \"completion-highlight\" : \"\"), value: c});\n                last = flag;\n            } else {\n                tokens[tokens.length - 1].value += c;\n            }\n        }\n\n        if (data.meta) {\n            var maxW = popup.renderer.$size.scrollerWidth / popup.renderer.layerConfig.characterWidth;\n            if (data.meta.length + data.caption.length < maxW - 2)\n                tokens.push({type: \"rightAlignedText\", value: data.meta});\n        }\n        // This is the new stuff: add icon tokens\n        if (data.icon) {\n            tokens.push({type: \"icon_\" + data.icon, value: \"\"});\n        }\n\n\n        return tokens;\n    };\n\n    return popup;\n};\n\ndom.importCssString(\"\\\n.ace_icon_function {\\\n    display: inline-block;\\\n    position: absolute;\\\n    left: 3px;\\\n    margin-top: 1px;\\\n    width: 14px;\\\n    height: 14px;\\\n    background-image: url('img/function.png');\\\n    background-size: 14px;\\\n    z-index: -1;\\\n}\\\n.ace_icon_local {\\\n    display: inline-block;\\\n    position: absolute;\\\n    left: 3px;\\\n    margin-top: 1px;\\\n    width: 14px;\\\n    height: 14px;\\\n    background-image: url('img/local.png');\\\n    background-size: 14px;\\\n    z-index: -1;\\\n}\\\n.ace_icon_type {\\\n    display: inline-block;\\\n    position: absolute;\\\n    left: 3px;\\\n    margin-top: 1px;\\\n    width: 14px;\\\n    height: 14px;\\\n    background-image: url('img/type.png');\\\n    background-size: 14px;\\\n    z-index: -1;\\\n}\\\n.ace_icon_property {\\\n    display: inline-block;\\\n    position: absolute;\\\n    left: 3px;\\\n    margin-top: 1px;\\\n    width: 14px;\\\n    height: 14px;\\\n    background-image: url('img/property.png');\\\n    background-size: 14px;\\\n    z-index: -1;\\\n}\\\n.ace_icon_snippet {\\\n    display: inline-block;\\\n    position: absolute;\\\n    left: 3px;\\\n    margin-top: 1px;\\\n    width: 14px;\\\n    height: 14px;\\\n    background-image: url('img/snippet.png');\\\n    background-size: 14px;\\\n    z-index: -1;\\\n}\\\n.ace_icon_file {\\\n    display: inline-block;\\\n    position: absolute;\\\n    left: 3px;\\\n    margin-top: 1px;\\\n    width: 14px;\\\n    height: 14px;\\\n    background-image: url('img/file.png');\\\n    background-size: 14px;\\\n    z-index: -1;\\\n}\\\n.ace_icon_action {\\\n    display: inline-block;\\\n    position: absolute;\\\n    left: 3px;\\\n    margin-top: 1px;\\\n    width: 14px;\\\n    height: 14px;\\\n    background-image: url('img/action.png');\\\n    background-size: 14px;\\\n    z-index: -1;\\\n}\");\n"]}